<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="744px" preserveAspectRatio="none" style="width:1705px;height:744px;background:#FFFFFF;" version="1.1" viewBox="0 0 1705 744" width="1705px" zoomAndPan="magnify"><defs><filter height="300%" id="fmvyo8murssf1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fmvyo8murssf1)" height="95.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="672.5" y="100.5625"/><rect fill="#FFFFFF" filter="url(#fmvyo8murssf1)" height="288.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="672.5" y="394.3594"/><rect fill="#FFFFFF" filter="url(#fmvyo8murssf1)" height="179.6641" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1141" y="475.4922"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="226.5" x2="226.5" y1="40.2969" y2="701.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="515.5" x2="515.5" y1="40.2969" y2="701.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="677.5" x2="677.5" y1="40.2969" y2="701.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="858.5" x2="858.5" y1="40.2969" y2="701.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1010.5" x2="1010.5" y1="40.2969" y2="701.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1145.5" x2="1145.5" y1="40.2969" y2="701.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1289.5" x2="1289.5" y1="40.2969" y2="701.1563"/><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="145" x="152.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="159.5" y="24.9951">LodeRunner::start</text><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="145" x="152.5" y="700.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="159.5" y="720.1514">LodeRunner::start</text><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="139" x="444.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="451.5" y="24.9951">LodeRunner::DAL</text><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="139" x="444.5" y="700.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="451.5" y="720.1514">LodeRunner::DAL</text><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="156" x="597.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="604.5" y="24.9951">InternalMessageBus</text><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="156" x="597.5" y="700.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="604.5" y="720.1514">InternalMessageBus</text><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="178" x="767.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="164" x="774.5" y="24.9951">StatusUpdateListeners</text><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="178" x="767.5" y="700.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="164" x="774.5" y="720.1514">StatusUpdateListeners</text><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="99" x="959.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="966.5" y="24.9951">LogListener</text><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="99" x="959.5" y="700.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="966.5" y="720.1514">LogListener</text><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="143" x="1072.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="1079.5" y="24.9951">UpdatePoolStatus</text><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="143" x="1072.5" y="700.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="1079.5" y="720.1514">UpdatePoolStatus</text><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="91" x="1242.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="1249.5" y="24.9951">CosmosDB</text><rect fill="#FEFECE" filter="url(#fmvyo8murssf1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="91" x="1242.5" y="700.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="1249.5" y="720.1514">CosmosDB</text><rect fill="#FFFFFF" filter="url(#fmvyo8murssf1)" height="95.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="672.5" y="100.5625"/><rect fill="#FFFFFF" filter="url(#fmvyo8murssf1)" height="288.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="672.5" y="394.3594"/><rect fill="#FFFFFF" filter="url(#fmvyo8murssf1)" height="179.6641" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1141" y="475.4922"/><ellipse cx="7.5" cy="70.6797" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="215,67.4297,225,71.4297,215,75.4297,219,71.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="12" x2="221" y1="71.4297" y2="71.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="15" y="66.3638">Start LodeRunner in wait state</text><polygon fill="#A80036" points="660.5,96.5625,670.5,100.5625,660.5,104.5625,664.5,100.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="227" x2="666.5" y1="100.5625" y2="100.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="234" y="95.4966">"Starting" message</text><polygon fill="#A80036" points="846.5,110.5625,856.5,114.5625,846.5,118.5625,850.5,114.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="682.5" x2="852.5" y1="114.5625" y2="114.5625"/><polygon fill="#A80036" points="999,144.6953,1009,148.6953,999,152.6953,1003,148.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="858.5" x2="1005" y1="148.6953" y2="148.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="865.5" y="143.6294">Log starting status</text><path d="M1016,127.5625 L1016,152.5625 L1269,152.5625 L1269,137.5625 L1259,127.5625 L1016,127.5625 " fill="#FBFB77" filter="url(#fmvyo8murssf1)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1259,127.5625 L1259,137.5625 L1269,137.5625 L1259,127.5625 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232" x="1022" y="144.6294">include starting configuration values</text><polygon fill="#A80036" points="869.5,163.6953,859.5,167.6953,869.5,171.6953,865.5,167.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="863.5" x2="1010" y1="167.6953" y2="167.6953"/><polygon fill="#A80036" points="693.5,177.6953,683.5,181.6953,693.5,185.6953,689.5,181.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="687.5" x2="857.5" y1="181.6953" y2="181.6953"/><polygon fill="#A80036" points="238,191.6953,228,195.6953,238,199.6953,234,195.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="232" x2="676.5" y1="195.6953" y2="195.6953"/><line style="stroke:#A80036;stroke-width:1.0;" x1="227" x2="269" y1="224.8281" y2="224.8281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="269" x2="269" y1="224.8281" y2="237.8281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="228" x2="269" y1="237.8281" y2="237.8281"/><polygon fill="#A80036" points="238,233.8281,228,237.8281,238,241.8281,234,237.8281" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="234" y="219.7622">validate start-up config</text><line style="stroke:#A80036;stroke-width:1.0;" x1="227" x2="269" y1="266.9609" y2="266.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="269" x2="269" y1="266.9609" y2="279.9609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="228" x2="269" y1="279.9609" y2="279.9609"/><polygon fill="#A80036" points="238,275.9609,228,279.9609,238,283.9609,234,279.9609" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="234" y="261.895">ensure secrets</text><line style="stroke:#A80036;stroke-width:1.0;" x1="227" x2="269" y1="309.0938" y2="309.0938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="269" x2="269" y1="309.0938" y2="322.0938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="228" x2="269" y1="322.0938" y2="322.0938"/><polygon fill="#A80036" points="238,318.0938,228,322.0938,238,326.0938,234,322.0938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275" x="234" y="304.0278">establish dataconnections and changefeed</text><polygon fill="#A80036" points="504,347.2266,514,351.2266,504,355.2266,508,351.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="227" x2="510" y1="351.2266" y2="351.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="234" y="346.1606">connect and configure</text><polygon fill="#A80036" points="238,361.2266,228,365.2266,238,369.2266,234,365.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="232" x2="515" y1="365.2266" y2="365.2266"/><polygon fill="#A80036" points="660.5,390.3594,670.5,394.3594,660.5,398.3594,664.5,394.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="227" x2="666.5" y1="394.3594" y2="394.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="234" y="389.2935">"Ready" message</text><polygon fill="#A80036" points="846.5,404.3594,856.5,408.3594,846.5,412.3594,850.5,408.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="682.5" x2="852.5" y1="408.3594" y2="408.3594"/><polygon fill="#A80036" points="999,438.4922,1009,442.4922,999,446.4922,1003,442.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="858.5" x2="1005" y1="442.4922" y2="442.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="865.5" y="437.4263">Write Ready status</text><path d="M1016,421.3594 L1016,446.3594 L1378,446.3594 L1378,431.3594 L1368,421.3594 L1016,421.3594 " fill="#FBFB77" filter="url(#fmvyo8murssf1)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1368,421.3594 L1368,431.3594 L1378,431.3594 L1368,421.3594 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341" x="1022" y="438.4263">should include CosmosDB &amp; ChangeFeed information</text><polygon fill="#A80036" points="869.5,457.4922,859.5,461.4922,869.5,465.4922,865.5,461.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="863.5" x2="1010" y1="461.4922" y2="461.4922"/><polygon fill="#A80036" points="1129,471.4922,1139,475.4922,1129,479.4922,1133,475.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="858.5" x2="1135" y1="475.4922" y2="475.4922"/><polygon fill="#A80036" points="527,485.4922,517,489.4922,527,493.4922,523,489.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="521" x2="1140" y1="489.4922" y2="489.4922"/><polygon fill="#A80036" points="1278,519.625,1288,523.625,1278,527.625,1282,523.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="516" x2="1284" y1="523.625" y2="523.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="523" y="518.5591">Update storage with current status</text><path d="M1295,502.4922 L1295,527.4922 L1696,527.4922 L1696,512.4922 L1686,502.4922 L1295,502.4922 " fill="#FBFB77" filter="url(#fmvyo8murssf1)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1686,502.4922 L1686,512.4922 L1696,512.4922 L1686,502.4922 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="380" x="1301" y="519.5591">information including zone, region, Id of the particular client</text><polygon fill="#A80036" points="527,538.625,517,542.625,527,546.625,523,542.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="521" x2="1289" y1="542.625" y2="542.625"/><polygon fill="#A80036" points="1129,552.625,1139,556.625,1129,560.625,1133,556.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="516" x2="1135" y1="556.625" y2="556.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1151" x2="1193" y1="606.957" y2="606.957"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1193" x2="1193" y1="606.957" y2="619.957"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1152" x2="1193" y1="619.957" y2="619.957"/><polygon fill="#A80036" points="1162,615.957,1152,619.957,1162,623.957,1158,619.957" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="1158" y="601.8911">Setup reresh timer</text><path d="M1290,569.625 L1290,639.625 L1548,639.625 L1548,579.625 L1538,569.625 L1290,569.625 " fill="#FBFB77" filter="url(#fmvyo8murssf1)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1538,569.625 L1538,579.625 L1548,579.625 L1538,569.625 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="1296" y="586.6919">Update status every 5 secs</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233" x="1296" y="601.8247">use last status and fresh timestamp</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="1296" y="616.9575">to ensure that the status is current</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="1296" y="632.0903">and is not evicted based on TTL</text><polygon fill="#A80036" points="869.5,651.1563,859.5,655.1563,869.5,659.1563,865.5,655.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="863.5" x2="1145" y1="655.1563" y2="655.1563"/><polygon fill="#A80036" points="693.5,665.1563,683.5,669.1563,693.5,673.1563,689.5,669.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="687.5" x2="857.5" y1="669.1563" y2="669.1563"/><polygon fill="#A80036" points="238,679.1563,228,683.1563,238,687.1563,234,683.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="232" x2="676.5" y1="683.1563" y2="683.1563"/><!--MD5=[bd8e0431b5906a2ebff52dfae1c70edb]
@startuml
participant "LodeRunner::start" as start
participant "LodeRunner::DAL" as DAL
participant "InternalMessageBus" as BUS
participant "StatusUpdateListeners" as StatusListeners
participant "LogListener" as Log
participant "UpdatePoolStatus" as PoolListener

[o-> start: Start LodeRunner in wait state

start -> BUS: "Starting" message
activate BUS
BUS -> StatusListeners
StatusListeners -> Log : Log starting status
note right
    include starting configuration values
end note
Log - -> StatusListeners
StatusListeners - -> BUS
BUS - -> start
deactivate BUS
start -> start: validate start-up config
start -> start: ensure secrets
start -> start: establish dataconnections and changefeed
start -> DAL: connect and configure
DAL - -> start
start -> BUS: "Ready" message
activate BUS
BUS -> StatusListeners
StatusListeners -> Log : Write Ready status 
note right
    should include CosmosDB & ChangeFeed information
end note
Log - -> StatusListeners
StatusListeners -> PoolListener 
activate PoolListener
PoolListener -> DAL
DAL -> CosmosDB: Update storage with current status
note right
    information including zone, region, Id of the particular client
end note
CosmosDB - -> DAL
DAL - -> PoolListener
PoolListener -> PoolListener: Setup reresh timer
note right
    Update status every 5 secs 
    use last status and fresh timestamp 
    to ensure that the status is current
    and is not evicted based on TTL
end note
PoolListener - -> StatusListeners
deactivate PoolListener
StatusListeners - -> BUS
BUS - -> start
deactivate BUS
@enduml

PlantUML version 1.2021.10beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>